<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Batch Effect Correction on Pancreatic Cells • Canek</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Batch Effect Correction on Pancreatic Cells">
<meta property="og:description" content="Canek">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-52309538-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-52309538-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">Canek</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/Pancreatic_Integration_2_Batches.html">Batch Effect Correction on Pancreatic Cells</a>
    </li>
    <li>
      <a href="../../articles/articles/Pancreatic_Integration_3_Batches.html">Batch Effect Correction on Pancreatic Cells (Multi-Batch)</a>
    </li>
    <li>
      <a href="../../articles/seurat.html">Run Canek on Seurat objects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Pancreatic_Integration_2_Batches_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Batch Effect Correction on Pancreatic Cells</h1>
            
      
      
      <div class="hidden name"><code>Pancreatic_Integration_2_Batches.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Canek</span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'spdep':</span>
<span class="co">#&gt;   method   from</span>
<span class="co">#&gt;   plot.mst ape</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.satijalab.org/seurat">SeuratData</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'cli':</span>
<span class="co">#&gt;   method     from    </span>
<span class="co">#&gt;   print.boxx spatstat</span></code></pre></div>
<p>In this example we integrate only two batches (celseq and celseq2). See the vignette “Batch Effect Correction on Pancreatic Cells (multiple batches)” for an example of multiple batches integration.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/SeuratData/man/InstallData.html">InstallData</a></span><span class="op">(</span><span class="st">"panc8"</span><span class="op">)</span>
<span class="co">#&gt; Installing package into '/Users/runner/work/_temp/Library'</span>
<span class="co">#&gt; (as 'lib' is unspecified)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/SplitObject.html">SplitObject</a></span><span class="op">(</span><span class="va">panc8</span>, split.by <span class="op">=</span> <span class="st">"tech"</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"celseq"</span>, <span class="st">"celseq2"</span><span class="op">)</span><span class="op">]</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/merge.Seurat.html">merge</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"celseq"</span><span class="op">]</span><span class="op">]</span>, <span class="va">x</span><span class="op">[[</span><span class="st">"celseq2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div id="data-preprocessing" class="section level1">
<h1 class="hasAnchor">
<a href="#data-preprocessing" class="anchor"></a>Data preprocessing</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/NormalizeData.html">NormalizeData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/FindVariableFeatures.html">FindVariableFeatures</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeaturePlot.html">VariableFeaturePlot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre></div>
<p><img src="Pancreatic_Integration_2_Batches_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">tech</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  celseq celseq2 </span>
<span class="co">#&gt;    1004    2285</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/ScaleData.html">ScaleData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Centering and scaling data matrix</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/RunPCA.html">RunPCA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; PC_ 1 </span>
<span class="co">#&gt; Positive:  SCG3, SYT7, ERO1LB, ABCC8, GAD2, VGF, MIR7-3HG, PLCXD3, KIF5C, MLXIPL </span>
<span class="co">#&gt;     G6PC2, STX1A, STMN2, PEG10, CFC1, RASD1, RGS4, SCD, SYT13, PRUNE2 </span>
<span class="co">#&gt;     SORL1, PCSK1, FAM105A, MEIS2, CRYBA2, LOC100216479, UCHL1, GC, FEV, SUSD4 </span>
<span class="co">#&gt; Negative:  IFITM3, ZFP36L1, COL4A2, S100A11, AHNAK, CLIC4, PMEPA1, FSTL1, REST, SERPINH1 </span>
<span class="co">#&gt;     SOX4, LAMC1, MSN, NOTCH2, COL4A1, PHLDA1, ANXA2, EPS8, FLNA, HK1 </span>
<span class="co">#&gt;     MICAL2, LITAF, CAV2, LGALS3, IFITM2, TPM1, PPP1R18, TUBB6, PXDN, MYOF </span>
<span class="co">#&gt; PC_ 2 </span>
<span class="co">#&gt; Positive:  SPARC, COL5A2, COL5A1, COL1A2, COL6A3, COL6A2, COL5A3, PDGFRB, COL15A1, MRC2 </span>
<span class="co">#&gt;     COL3A1, NID1, FBN1, COL1A1, SFRP2, LUM, LOXL2, CDH11, LAMA4, CYGB </span>
<span class="co">#&gt;     THBS2, LTBP2, BGN, PRRX1, WNT5A, LHFP, EDNRA, ITGA1, ITGA11, DKK3 </span>
<span class="co">#&gt; Negative:  TACSTD2, KRT18, KRT8, SERPINA3, ANXA4, TM4SF1, CFB, SDC4, CLDN4, PDZK1IP1 </span>
<span class="co">#&gt;     KRT7, TMC5, MUC1, LCN2, GATM, SAT1, TC2N, IL32, BACE2, AKR1C3 </span>
<span class="co">#&gt;     SOD2, SERINC2, ABCC3, CLDN1, MUC20, CD44, LAD1, SPINK1, TMPRSS2, NR5A2 </span>
<span class="co">#&gt; PC_ 3 </span>
<span class="co">#&gt; Positive:  KCNQ1OT1, PGM5P2, ARRDC3-AS1, LOC100131257, UGDH-AS1, LOC642236, HYDIN2, TMEM212, KDM4A-AS1, ESRG </span>
<span class="co">#&gt;     LOC643406, POLH, LOC440300, LOC100130954, EMX2OS, GSG1, GATM-AS1, VSTM4, OLAH, TNFAIP8L1 </span>
<span class="co">#&gt;     LPAL2, ARHGEF26-AS1, GPR82, SYNPO2L, PCDH11Y, LOC90834, GNRHR2, ANKRD20A9P, ODF2L, L2HGDH </span>
<span class="co">#&gt; Negative:  SEL1L3, LGR4, RASEF, OCLN, TACSTD2, ATP10B, GDF15, CFB, CD44, SH3BP4 </span>
<span class="co">#&gt;     BACE2, MTUS1, TC2N, NR5A2, ABCC3, GSTA2, CLDN1, SOD2, NFIB, GULP1 </span>
<span class="co">#&gt;     GSTA1, TMPRSS2, B3GNT7, KLK1, SPTBN1, CYB5A, KCNQ1, CEL, IQGAP2, TPM1 </span>
<span class="co">#&gt; PC_ 4 </span>
<span class="co">#&gt; Positive:  CFTR, ONECUT2, DCDC2, AQP1, VTCN1, ALDH1A3, SPP1, KRT19, IGFBP7, DEFB1 </span>
<span class="co">#&gt;     SLC4A4, SERPING1, TINAGL1, MMP7, SERPINA5, PPARGC1A, PMEPA1, PDGFD, ANXA3, TFPI2 </span>
<span class="co">#&gt;     HSD17B2, SCNN1A, AKAP7, KRT23, APCDD1, CTSH, PROM1, TSPAN8, CEACAM7, KRT80 </span>
<span class="co">#&gt; Negative:  CPA2, PLA2G1B, CPA1, PRSS3P2, CTRC, PNLIP, CTRB2, PRSS1, CEL, CTRB1 </span>
<span class="co">#&gt;     KLK1, GSTA2, CPB1, PRSS3, REG1B, CELA2A, BCAT1, CELA3A, ALB, SPINK1 </span>
<span class="co">#&gt;     PNLIPRP2, PNLIPRP1, AOX1, FAM129A, ALDOB, CELA3B, GSTA1, REG1A, CTRL, C15orf48 </span>
<span class="co">#&gt; PC_ 5 </span>
<span class="co">#&gt; Positive:  PECAM1, ESAM, SOX18, KDR, CD93, ACVRL1, ELTD1, GPR4, PLVAP, FLT1 </span>
<span class="co">#&gt;     MYCT1, EXOC3L2, ABI3, NOTCH4, EMCN, ERG, CALCRL, ECSCR, S1PR1, PTPRB </span>
<span class="co">#&gt;     GIMAP4, RGCC, TIE1, RHOJ, COL13A1, MMRN2, GIMAP8, CLEC14A, PODXL, CDH5 </span>
<span class="co">#&gt; Negative:  COL5A1, SFRP2, COL6A3, THBS2, NOTCH3, COL3A1, LTBP2, LUM, PDGFRB, CDH11 </span>
<span class="co">#&gt;     COL5A3, COL5A2, COL6A1, ITGA11, PRRX1, LAMA2, FN1, TNFAIP6, COL1A2, COL1A1 </span>
<span class="co">#&gt;     COL12A1, GFPT2, WNT5A, COL6A2, SPON2, FMOD, CRLF1, ANTXR1, CYGB, LAMC3</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/RunUMAP.html">RunUMAP</a></span><span class="op">(</span><span class="va">x</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>
<span class="co">#&gt; Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric</span>
<span class="co">#&gt; To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'</span>
<span class="co">#&gt; This message will be shown once per session</span>
<span class="co">#&gt; 06:44:22 UMAP embedding parameters a = 0.9922 b = 1.112</span>
<span class="co">#&gt; 06:44:22 Read 3289 rows and found 30 numeric columns</span>
<span class="co">#&gt; 06:44:22 Using Annoy for neighbor search, n_neighbors = 30</span>
<span class="co">#&gt; 06:44:22 Building Annoy index with metric = cosine, n_trees = 50</span>
<span class="co">#&gt; 0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="co">#&gt; [----|----|----|----|----|----|----|----|----|----|</span>
<span class="co">#&gt; **************************************************|</span>
<span class="co">#&gt; 06:44:22 Writing NN index file to temp file /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpWTPavL/fileab51dd144fd</span>
<span class="co">#&gt; 06:44:22 Searching Annoy index using 1 thread, search_k = 3000</span>
<span class="co">#&gt; 06:44:23 Annoy recall = 100%</span>
<span class="co">#&gt; 06:44:23 Commencing smooth kNN distance calibration using 1 thread</span>
<span class="co">#&gt; 06:44:25 Initializing from normalized Laplacian + noise</span>
<span class="co">#&gt; 06:44:25 Commencing optimization for 500 epochs, with 134188 positive edges</span>
<span class="co">#&gt; 06:44:29 Optimization finished</span></code></pre></div>
</div>
<div id="umap-plot-before-correction" class="section level1">
<h1 class="hasAnchor">
<a href="#umap-plot-before-correction" class="anchor"></a>UMAP plot before correction</h1>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/DimPlot.html">DimPlot</a></span><span class="op">(</span><span class="va">x</span>, group.by <span class="op">=</span> <span class="st">"tech"</span><span class="op">)</span></code></pre></div>
<p><img src="Pancreatic_Integration_2_Batches_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/DimPlot.html">DimPlot</a></span><span class="op">(</span><span class="va">x</span>, group.by <span class="op">=</span> <span class="st">"celltype"</span><span class="op">)</span></code></pre></div>
<p><img src="Pancreatic_Integration_2_Batches_files/figure-html/unnamed-chunk-7-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="run-canek" class="section level1">
<h1 class="hasAnchor">
<a href="#run-canek" class="anchor"></a>Run Canek</h1>
<p>We pass the column containing the batch information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/RunCanek.html">RunCanek</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tech"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/ScaleData.html">ScaleData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Centering and scaling data matrix</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/FindVariableFeatures.html">FindVariableFeatures</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning in eval(predvars, data, env): NaNs produced</span>
<span class="co">#&gt; Warning in hvf.info$variance.expected[not.const] &lt;- 10^fit$fitted: number of</span>
<span class="co">#&gt; items to replace is not a multiple of replacement length</span>
<span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeaturePlot.html">VariableFeaturePlot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning in self$trans$transform(x): NaNs produced</span>
<span class="co">#&gt; Warning: Transformation introduced infinite values in continuous x-axis</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="Pancreatic_Integration_2_Batches_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/RunPCA.html">RunPCA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; PC_ 1 </span>
<span class="co">#&gt; Positive:  IFITM3, ZFP36L1, REST, S100A11, CLIC4, SOX4, AHNAK, MICAL2, CAV2, PMEPA1 </span>
<span class="co">#&gt;     ANXA2, LAMC1, NOTCH2, CD44, EPS8, SH3BP4, COL4A2, IFITM2, LGALS3, PHLDA1 </span>
<span class="co">#&gt;     TPM1, LITAF, NFIB, SERPINH1, SPTBN1, ANXA2P2, MYOF, SAT1, TFPI, MSN </span>
<span class="co">#&gt; Negative:  SCG3, SYT7, ERO1LB, ABCC8, GAD2, VGF, MIR7-3HG, PLCXD3, KIF5C, G6PC2 </span>
<span class="co">#&gt;     STX1A, MLXIPL, PEG10, STMN2, CFC1, RGS4, SCD, RASD1, SYT13, PRUNE2 </span>
<span class="co">#&gt;     SORL1, UCHL1, MEIS2, PCSK1, FAM105A, LOC100216479, GC, CRYBA2, FEV, SUSD4 </span>
<span class="co">#&gt; PC_ 2 </span>
<span class="co">#&gt; Positive:  SPARC, COL5A1, COL5A2, COL1A2, COL6A3, PDGFRB, COL6A2, COL5A3, COL15A1, MRC2 </span>
<span class="co">#&gt;     COL3A1, NID1, FBN1, CDH11, LAMA4, LUM, SFRP2, LOXL2, BGN, LTBP2 </span>
<span class="co">#&gt;     THBS2, CYGB, PRRX1, WNT5A, LHFP, COL1A1, COL4A1, IGFBP4, EDNRA, COL6A1 </span>
<span class="co">#&gt; Negative:  TACSTD2, SERPINA3, CFB, KRT8, ANXA4, TMC5, KRT18, TM4SF1, SDC4, KRT7 </span>
<span class="co">#&gt;     TC2N, CLDN4, OCLN, RASEF, GATM, PDZK1IP1, ABCC3, MUC1, BACE2, SOD2 </span>
<span class="co">#&gt;     IL32, NR5A2, CLDN1, AKR1C3, LAD1, ATP10B, CPM, SAT1, CLMN, SLC16A7 </span>
<span class="co">#&gt; PC_ 3 </span>
<span class="co">#&gt; Positive:  ATP10B, LGR4, GSTA2, SERF2-C15ORF63, TC2N, CD44, GDF15, NR5A2, KLK1, TACSTD2 </span>
<span class="co">#&gt;     CFB, GSTA1, CEL, B3GNT7, OCLN, BCAT1, CYB5A, PLA2G1B, XBP1, SH3BP4 </span>
<span class="co">#&gt;     BACE2, MTUS1, IL32, TMPRSS2, GATA4, AKR1C3, ALDOB, TMEM97, TPST2, TPM1 </span>
<span class="co">#&gt; Negative:  KCNQ1OT1, PGM5P2, UGDH-AS1, ARRDC3-AS1, LOC100131257, LOC643406, MAB21L3, LOC642236, TMEM212, HYDIN2 </span>
<span class="co">#&gt;     KDM4A-AS1, GATM-AS1, POLH, ESRG, LOC440300, GSG1, EMX2OS, LOC100130954, OLAH, LPAL2 </span>
<span class="co">#&gt;     ARHGEF26-AS1, ANKRD20A9P, GPR82, TNFAIP8L1, SYNPO2L, ODF2L, LOC90834, GNRHR2, VSTM4, L2HGDH </span>
<span class="co">#&gt; PC_ 4 </span>
<span class="co">#&gt; Positive:  CFTR, ONECUT2, DCDC2, ALDH1A3, AQP1, VTCN1, SPP1, KRT19, SLC4A4, IGFBP7 </span>
<span class="co">#&gt;     DEFB1, SERPING1, TINAGL1, MMP7, ANXA3, SERPINA5, TFPI2, SCNN1A, BICC1, PMEPA1 </span>
<span class="co">#&gt;     PPARGC1A, PDGFD, HSD17B2, NDRG2, AKAP7, KRT23, CTSH, PKHD1, APCDD1, TSPAN8 </span>
<span class="co">#&gt; Negative:  CPA2, PRSS1, PRSS3P2, PLA2G1B, CPA1, CTRC, PNLIP, CTRB2, KLK1, CTRB1 </span>
<span class="co">#&gt;     CEL, PRSS3, BCAT1, GSTA2, CPB1, CELA2A, REG1B, CELA3A, PNLIPRP2, SPINK1 </span>
<span class="co">#&gt;     AOX1, ALB, PNLIPRP1, FAM129A, CBS, ALDOB, REG1A, GSTA1, CELA3B, CTRL </span>
<span class="co">#&gt; PC_ 5 </span>
<span class="co">#&gt; Positive:  COL5A1, SFRP2, COL6A3, THBS2, NOTCH3, COL3A1, COL1A1, LTBP2, LUM, CDH11 </span>
<span class="co">#&gt;     PDGFRB, COL5A3, COL5A2, ITGA11, COL6A1, PRRX1, LAMA2, TNFAIP6, FN1, COL1A2 </span>
<span class="co">#&gt;     COL12A1, COL6A2, GFPT2, WNT5A, SPON2, FMOD, ANTXR1, CRLF1, CYGB, LAMC3 </span>
<span class="co">#&gt; Negative:  PECAM1, ESAM, SOX18, KDR, CD93, ACVRL1, ELTD1, GPR4, PLVAP, FLT1 </span>
<span class="co">#&gt;     MYCT1, EXOC3L2, ABI3, NOTCH4, EMCN, ERG, CALCRL, ECSCR, S1PR1, PTPRB </span>
<span class="co">#&gt;     GIMAP4, RGCC, TIE1, RHOJ, COL13A1, GIMAP8, MMRN2, CLEC14A, PODXL, CDH5</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/RunUMAP.html">RunUMAP</a></span><span class="op">(</span><span class="va">x</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>
<span class="co">#&gt; 06:44:46 UMAP embedding parameters a = 0.9922 b = 1.112</span>
<span class="co">#&gt; 06:44:46 Read 3289 rows and found 30 numeric columns</span>
<span class="co">#&gt; 06:44:46 Using Annoy for neighbor search, n_neighbors = 30</span>
<span class="co">#&gt; 06:44:46 Building Annoy index with metric = cosine, n_trees = 50</span>
<span class="co">#&gt; 0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="co">#&gt; [----|----|----|----|----|----|----|----|----|----|</span>
<span class="co">#&gt; **************************************************|</span>
<span class="co">#&gt; 06:44:47 Writing NN index file to temp file /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpWTPavL/fileab550b2b785</span>
<span class="co">#&gt; 06:44:47 Searching Annoy index using 1 thread, search_k = 3000</span>
<span class="co">#&gt; 06:44:47 Annoy recall = 100%</span>
<span class="co">#&gt; 06:44:48 Commencing smooth kNN distance calibration using 1 thread</span>
<span class="co">#&gt; 06:44:49 Initializing from normalized Laplacian + noise</span>
<span class="co">#&gt; 06:44:49 Commencing optimization for 500 epochs, with 136788 positive edges</span>
<span class="co">#&gt; 06:44:54 Optimization finished</span></code></pre></div>
</div>
<div id="umap-plot-after-correction" class="section level1">
<h1 class="hasAnchor">
<a href="#umap-plot-after-correction" class="anchor"></a>UMAP plot after correction</h1>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/DimPlot.html">DimPlot</a></span><span class="op">(</span><span class="va">x</span>, group.by <span class="op">=</span> <span class="st">"tech"</span><span class="op">)</span></code></pre></div>
<p><img src="Pancreatic_Integration_2_Batches_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/DimPlot.html">DimPlot</a></span><span class="op">(</span><span class="va">x</span>, group.by <span class="op">=</span> <span class="st">"celltype"</span><span class="op">)</span></code></pre></div>
<p><img src="Pancreatic_Integration_2_Batches_files/figure-html/unnamed-chunk-12-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Martin Loza, Diego Diez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
